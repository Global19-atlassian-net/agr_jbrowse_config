curieUrl = function(track,f) {
    var curie = f.get('curie');
    return 'http://www.alliancegenome.org/gene/'+curie; }

geneColor = function(feature) {
    var type = feature.get('type');
    var biotype = feature.get('so_term_name');
    if (!(typeof biotype === 'undefined') && biotype != 'protein_coding_gene') {return 'gray';}
    if (typeof biotype === 'undefined') {
        var parent = feature._parent;
        var parenttype = parent.get('so_term_name');
        if (!(typeof parenttype === 'undefined') && biotype != 'protein_coding_gene') {return 'gray';}
    }
    if (type.match(/exon/)) {return 'gray';}
    if (type.match(/pseudo/)) {return 'gray';}
    if (type.match(/miRNA/)) {return 'gray';}
    var strand = feature.get('strand');
    if (strand == -1) {return 'teal';}
    if (strand ==  1) {return 'darkviolet';}
    return 'gray'; }

geneHeight = function(f) {
    var type = f.get('type'); 
    if (type == 'CDS') {return 10;} 
    return 6;  
    }

exonColor = function(f) {
    var strand = f.get('strand');
    if (strand == -1) {return 'turquoise';}
    if (strand ==  1) {return 'violet';}
    return 'gray';
    }

geneURL = function(track,f) {
    var type = f.get('type');
    var source = f.get('source');
    if (type == 'ncRNA' && source == 'RNAz') {return; }
    var name = f.get('name');
    if (type == 'gene') {return 'http://www.wormbase.org/get?name='+name+';class=Gene'; }
    return;}

simpleGeneURL = function(track,f) {
    var name = f.get('Name');
    return 'http://www.wormbase.org/get?name='+name+';class=Gene';}

transcriptURL = function(track,f) {
    console.log(f);
    var parent = f.get('jbrowse_parent');
    var str = parent.replace(/Gene:/, '');
    console.log(str);
    return 'http://www.wormbase.org/get?name='+str+';class=Gene';}

geneGlyph = function(f) {
    var biotype = f.get('so_term_name');
    if (!(f.children())) {return 'JBrowse/View/FeatureGlyph/Box';}
    var type = f.get('type');
    if (type.match(/_gene/))    {return 'plugins/wormbase-glyphs/js/NoncodingTranscript';}
    if (typeof biotype === 'undefined') {return 'plugins/wormbase-glyphs/js/WBGene';}
    if (biotype=='tRNA_gene')  {return 'plugins/wormbase-glyphs/js/NoncodingGene';}
    if (biotype=='snoRNA_gene'){return 'plugins/wormbase-glyphs/js/NoncodingGene';}
    if (biotype=='snRNA_gene') {return 'plugins/wormbase-glyphs/js/NoncodingGene';}
    if (biotype=='scRNA_gene') {return 'plugins/wormbase-glyphs/js/NoncodingGene';}
    if (biotype=='rRNA_gene')  {return 'plugins/wormbase-glyphs/js/NoncodingGene';}
    if (biotype=='piRNA_gene') {return 'plugins/wormbase-glyphs/js/NoncodingGene';}
    if (biotype=='miRNA_gene') {return 'plugins/wormbase-glyphs/js/MiRNAGene';}
    if (biotype=='lincRNA_gene'){return 'plugins/wormbase-glyphs/js/NoncodingGene';}
    if (biotype.match(/lncRNA/)){return 'plugins/wormbase-glyphs/js/NoncodingGene';}
    if (biotype=='ncRNA_gene') {return 'plugins/wormbase-glyphs/js/NoncodingGene';}
    if (biotype=='pseudogene') {return 'plugins/wormbase-glyphs/js/NoncodingGene';}
    if (biotype=='protein_coding_gene') {return 'plugins/wormbase-glyphs/js/WBGene';}
    if (biotype=='gene') {return 'plugins/wormbase-glyphs/js/WBGene';}
    return 'plugins/wormbase-glyphs/js/NoncodingGene'; }

geneLinkLabel = function(track,f) {
    var type = f.get('type');
    var patt = /RNA|transcript/;
    if (patt.test(type)) {return f.get('Name');}
    var aliases = f.get('Alias');
    var locus;
    if (Array.isArray(aliases)) {locus = aliases[0];  }
        else {locus = aliases;}
    var name = f.get('sequence_name');
    if (locus == name) {return name; }
    if (typeof locus === 'undefined') {return name;}
    return locus+' ('+name+')';  }

geneLabel = function(f) {
    var type = f.get('type');
    var patt = /RNA|transcript/;
    if (patt.test(type)) {return f.get('Name');}
    var aliases = f.get('Alias');
    var locus;
    if (Array.isArray(aliases)) {locus = aliases[0];  }
        else {locus = aliases;}
    var name = f.get('sequence_name');
    if (locus == name) {return name; }
    if (typeof locus === 'undefined') {return name;}
    if (name == 'undefined' || typeof name === 'undefined' ) {return locus;}
    return locus+' ('+name+')';  }


